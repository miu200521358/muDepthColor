M4Layer

オフスクリーンレンダリングレイヤーです。

◆概要
よく画像編集ソフトにあるレイヤーの合成モードみたいなのをポストエフェクトに対して行うためのポストエフェクトです。
また、マスクによって特定の部分のみに適用することも可能です。
既定では何もしませんので、パラメータを編集してご利用ください。


◆使用可能な合成方法
M4Layer.fx の LAYER_MODE を編集することにより、合成方法を選択できます。
各合成モードの意味については大体世の中にある画像編集ソフトと同じだと思うので、
名称で検索するとたぶんわかります。あと、Photoshop や Fireworks のヘルプとかでも。
http://help.adobe.com/ja_JP/fireworks/cs/using/WS4c25cfbb1410b0021e63e3d1152b00d169-7fd8.html#WS4c25cfbb1410b0021e63e3d1152b00d169-7fd5

0: 通常
1: 加算
2: 減算
3: 乗算
4: スクリーン
5: オーバーレイ
6: ハードライト
7: ソフトライト
8: ビビッドライト
9: リニアライト
10: ピンライト
11: 覆い焼き (カラー)
12: 焼き込み (カラー)
13: 比較 (暗)
14: 比較 (明)
15: 差の絶対値
16: 除外

17: 色相			: 前景の色相を背景の彩度輝度に合成します。
18: 彩度			: 前景の彩度を背景の色相輝度に合成します。
19: カラー (色相と彩度)	: 前景の色相彩度を背景の輝度に合成します。
20: 輝度			: 前景の輝度を背景の色相彩度に合成します。


◆使用方法
他のポストエフェクトをまず読み込み、エフェクト割り当てから LayerRT でそのポストエフェクトにチェックを入れて有効にし、
LAYER_MODE を変えてみてください。
例えば、グレイスケールにするようなエフェクトを読み込み、このエフェクトを読み込み、LAYER_MODE をオーバーレイにしたり。

また、LayerRT 上で任意のシェーダ系エフェクトを割り当てることでシェーダ系エフェクトの合成方法が選べます。
他にも描画順やエフェクト割り当てをいじってみると面白いです。
パーティクル系エフェクトの .fx をパーティクル .x に割り当ててみたりとか、複合ポストエフェクトで本体以外の .fx を適当に割り当ててみるとか。

Tr および Si 値によりレイヤーと元画像の合成率を調整できます。
Si  * Tr で 1 が完全に合成で 0 が元画像のままになります。
Si は 1 を超える値や負の値を取ることも可能です。


■マスクの使用方法
LayerMaskRT で InvisibleMask.fx を割り当てたものはレイヤー合成の影響を受けません。


◆その他
・ポストエフェクトを適用しつつ一部分のみを通常描画したりするためにも使えますが、
  その用途であればデータPの Exclude が最強だと思いますのでそちらがいいと思います。
・もしかしたらエフェクト製作者/改変者が合成方法の式をコピペするためのソースとして使うのが一番正しい使い方かもしれません。
  もともと PostRimLighting の加算合成部分を汎用化できないかと思って作ったものですので、丸ごと流用でも可です。

◆改変、再配布について
ご自由にどうぞ。


◆更新履歴

Release 8, Fri, 24 Jan 2014

	背面が透明な場所だとレイヤー上に描画した物も映らないのを修正

Release 7, Mon, 02 Oct 2013

	透明度に対応するオプションを追加

Release 6, Mon, 29 Oct 2012

	MME 0.32 で RT 上のモデルが強制的にサブセット展開されるのとシェーダを指定できないのを修正

Release 5, Mon, 27 Aug 2012

	動作していなかったのを修正

Release 4, Mon, 16 Jul 2012

	MikuMikuMoving で読み込むとエラーが発生するのを修正

Release 3, Thu, 24 May 2012

	色相、彩度、カラー、輝度のモードを追加

Release 2, Tue, 22 May 2012

	Si でもブレンド値を指定できるようになりました
	LAYER_RT 0 時にも LAYER_MASK が使用可能になりました
	LAYER_MASK_INVERT が追加されました

Release 1, Sun, 20 May 2012

	製作

----
ミーフォ茜 <star@glasscore.net>