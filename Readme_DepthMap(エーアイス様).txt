//////////////////////////////////////////////////////////////////////////////
// DepthMap for MMD/MMM
// 2014/10/12 初版リリース
//////////////////////////////////////////////////////////////////////////////

■効果
Depth Mapを作成するポストエフェクトです。
MMD/MMMから画像あるいは動画として出力してしまうと2Dとなり深度情報は失われてしまいますが、
カメラから見て手前を白、うしろを黒と表すDepth Map（グレースケール）を作ることで深度を取ることが出来ます。

主にAfter Effectsなどに使用することを想定しています。

「DepthMap(znear無し)」
zfarのみでの黒フォグ操作

「DepthMap(znear有り)」
zNear、zFar両方の黒フォグ操作が可能


製作：エーアイス


■使い方
==============================================================================
・MikuMikuDance
DepthMap.xを読み込む。

（znear無し版）
黒フォグの距離を変えたい場合は、Depth.fxsubファイルをメモ帳などで開き、9行目の「float zfar = 200;」
の値を変更することでfar（黒フォグの距離）を変更することができます。

（znear有り版）
Depth.fxsubファイルをメモ帳などで開き、11行目の「float znear = 20;」12行目の「float zfar = 80;」
の値を変更することで、黒フォグの距離を変更することができます。
　・znear はカメラから見て手前の黒フォグ距離
　・zfarはカメラから見て後の黒フォグ距離
※仕様上、正常に動く値の範囲は「znear < zfar」となります。

・MikuMikuMoving
DepthMap.fxを読み込む。

エフェクトプロパティパラメータ

zFar 　 ・・・　Farの距離の操作
（znear有り版）
zNear　・・・　Nearの距離の操作

※1 MMMは動的パースにも対応しています。
※2 仕様上、正常に動く値の範囲は「znear < zfar」となります。


---


・Tips : 基本は画面全体にかけるようになっていますが、エフェクトファイルを以下のように変更することで
モデルやアクセサリなどに個別にかけることも出来ます。

１．「Depth.fxsub」を 「Depth.fx」と拡張子をリネーム
２．「Depth.fx」をモデル、アクセサリにエフェクト割り当て


なお、出力したDepthMap映像はAfter Effectsで「露出」エフェクトをかけると便利に。


あと「DepthMap.fx」の２行目
「//#define USE_DEPTH_INVERSE」を
「#define USE_DEPTH_INVERSE」
とコメントアウトを外すことで白黒反転できます。



エフェクト配布場所
http://seiga.nicovideo.jp/seiga/im4372355

なにかお気づきの点があれば下記まで
http://twitter.com/aice_black



■更新履歴
2015/7/31
zNear版追加

2015/1/1
zFar追加に伴いコードを若干変更

2014/10/17
カメラ位置、角度によって変な黒い影がちらつくバグ修正


■免責
==============================================================================
改変・再配布は自由です。連絡もいりません。

当ファイルを使用して生じたいかなる損害に対しても、当方は一切責任を負いません。
自己責任でご使用ください。